---
sidebar_position: 3
---

import ViewSource from "@site/src/components/ViewSource/ViewSource";
import Answer from "@site/src/components/Answer";

# 物体の運動のシミュレーション

今回は、物体の運動をシミュレーションしてみましょう。

## 等速直線運動

まずは、比較的簡単な等速直線運動から考えていきましょう。

初速度 $v_0$ と $t$ 秒後の変位 $x$ の関係は次のようになります。

$$
\frac{dx}{dt} = v_0
$$

この微分方程式は解析的に解けますが、差分化して差分方程式を作ってみましょう。

$$
\begin{align*}
    \frac{x_{n+1} - x_n}{\Delta t} &= v_0 \\
    \therefore x_{n + 1} - x_n     &= v_0 \Delta t \\
    \therefore x_{n + 1}           &= x_n + v_0 \Delta t
\end{align*}
$$

よって、$\Delta t$ を十分小さくとって $x_1,x_2,x_3 \cdots$ を順に求めていけば、$x$ が求まります。実際に、これを使って $t$ 秒後の変位 $x$ を求めるプログラムを作ってみましょう。

<ViewSource path="/simulation/uniform_linear_motion.ipynb" />

:::note
この微分方程式は、次のようにすれば簡単に解けます。確かにこの結果を用いれば、簡単にプログラムを書けるので、差分方程式を使う必要性があまり感じられないかもしれません。しかし、世の中には解析的に解けない微分方程式も多いので、差分方程式を使って近似解を求めることも時には重要になってきます。

$$
\begin{align*}
    \frac{dx}{dt}      &= v_0 \\
    \therefore dx      &= v_0 dt \\
    \therefore \int dx &= \int v_0 dt \\
    \therefore x       &= v_0t+C
\end{align*}
$$

初期条件 $t = 0$ で $x = x_0$ を代入して、

$$
C = x_0
$$

よって、

$$
x = x_0 + v_0t
$$

この結果を使えば、次のようにより簡単に書けます。

<ViewSource path="/simulation/uniform_linear_motion_analytical.ipynb" />

:::

### 可視化

実際にプログラムができたので、次は可視化してみましょう。

今のままでは最終的な変位のみで途中の経過が分からないので、まずは、`uniform_linear_motion` 関数を少し変えて途中経過も含めた変位の配列を返すように書き換えましょう。次のようになります。

<ViewSource path="/simulation/uniform_linear_motion_return_array.ipynb" />

物体のあるセルを白く塗る関数を作って、可視化してみましょう。

物体のある $x$ 座標と $y$ 座標を取得して、そこのセルだけ白く塗る関数を作ってみましょう。次のようになります。

<ViewSource path="/simulation/draw_cell.ipynb" />

これを使って、可視化すると、次のようになります。

<ViewSource path="/simulation/uniform_linear_motion_view.ipynb" />

:::note
解析解を使うと次のようになります。

<ViewSource path="/simulation/uniform_linear_motion_view_analytical.ipynb" />
:::

## 放物運動

次は、もう少し複雑な放物運動を考えましょう。

初速度を $v_0$ 、$x$ 軸方向の速度を $v_x$ 、$y$ 軸方向の速度も $v_y$ 、重力加速度を $g$ 、 $t$ 秒後の変位を $x,y$ として、仰角 $\theta$ で物体を投げたとします。

これらの関係は、次のようになります。

$$
\begin{align*}
    \frac{dx}{dt}   &= v_x \\
    \frac{dy}{dt}   &= v_y \\
    \frac{dv_x}{dt} &= 0 \\
    \frac{dv_y}{dt} &= -g
\end{align*}
$$

これを差分化してみましょう。

$$
\begin{align*}
    \frac{x_{n + 1} - x_n}{\Delta t}              &= {v_x}_n \\
    \therefore x_{n + 1} - x_n                    &= {v_x}_n \Delta t \\
    \therefore x_{n + 1}                          &= x_n + {v_x}_n \Delta t
\end{align*}
$$

他も同様にすると、次のようになります。

$$
\begin{align*}
    x_{n + 1}     &= x_n + {v_x}_n \Delta t \\
    y_{n + 1}     &= y_n + {v_y}_n \Delta t \\
    {v_x}_{n + 1} &= {v_x}_n \\
    {v_y}_{n + 1} &= {v_y}_n - g\Delta t
\end{align*}
$$

これを使って $t$ 秒後の変位 $x,y$ を求めるプログラムを作ってみましょう。

<ViewSource path="/simulation/parabolic_motion.ipynb" />

先程と同じように途中経過の変位の配列を返すように書き換えましょう。次のようになります。

<ViewSource path="/simulation/parabolic_motion_return_array.ipynb" />

これを使って可視化すると次のようになります。

<ViewSource path="/simulation/parabolic_motion_view.ipynb" />

:::note
この微分方程式も次のようにすれば簡単に解けます。

$x$ 軸方向は次のように解けます。

$$
\begin{align*}
    \frac{d^2x}{dt^2}        &= 0 \\
    \therefore \frac{dx}{dt} &= C \\
\end{align*}
$$

初期条件 $t = 0$ で $\frac{dx}{dt} = v_0 \cos \theta$ を代入して、

$$
\begin{align*}
    \frac{dx}{dt} &=v_0 \cos \theta \\
    \therefore x  &= v_0 t \cos \theta + D \\
\end{align*}
$$

初期条件 $t = 0$ で $x = 0$ を代入して、

$$
x = v_0 t \cos \theta
$$

$y$ 軸方向は次のように解けます。

$$
\begin{align*}
    \frac{d^2y}{dt^2}        &= -g \\
    \therefore \frac{dy}{dt} &= -gt + C \\
\end{align*}
$$

初期条件 $t = 0$ で $\frac{dy}{dt} = v_0 \sin \theta$ を代入して、

$$
\begin{align*}
    \frac{dy}{dt} &= -gt + v_0 \sin \theta \\
    \therefore y  &= -\frac{1}{2}gt^2 + v_0 t \sin \theta + D \\
\end{align*}
$$

初期条件 $t = 0$ で $y = 0$ を代入して、

$$
y = -\frac{1}{2}gt^2 + v_0 t \sin \theta
$$

これを使えば、次のようになります。

<ViewSource path="/simulation/uniform_linear_motion_view_analytical.ipynb" />

:::

## 速度に比例した抵抗がある投げ上げ運動

次は、さらに複雑な運動について考えましょう。

鉛直上向きの初速度を $v_0$ 、鉛直上向きの速度を $v$ 、重力加速度を $g$ 、 $t$ 秒後の変位を $y$ 、比例定数 $k$ に対して速度に比例した抵抗 $kv$ があるとします。

運動方程式は次のようになります。

$$
\begin{align*}
    m\frac{d^2y}{dt^2}           &= -mg - kv \\
    \therefore \frac{d^2y}{dt^2} &= -g - \frac{k}{m}v
\end{align*}
$$

よって、これらの関係は次のようになります。

$$
\begin{align*}
    \frac{dy}{dt} &= v \\
    \frac{dv}{dt} &= -g - \frac{k}{m}v
\end{align*}
$$

これを差分化して、差分方程式を作ると次のようになります。

$$
\begin{align*}
    y_{n + 1} &= y_n + v_n\Delta t \\
    v_{n + 1} &= v_n - g\Delta t - \frac{k}{m}v_n \Delta t
\end{align*}
$$

これを用いて、$t$ 秒後の変位 $y$ を求めて可視化するプログラムを作ってみましょう。

次のようになります。領域外に出てしまうとエラーが出てしまうので、初期位置の $y$ 座標を 100 にしました。

<ViewSource path="/simulation/resisted_motion_view.ipynb" />

これは可視化しても正しく動いているか、あまりよくわかりませんね（笑）

:::note
この微分方程式も少し大変ですが、解析的に解くことができます。

$$
\begin{align*}
    \frac{d^2y}{dt^2}                             &= -g - \frac{k}{m}v \\
    \therefore \frac{dv}{dt}                      &= -g - \frac{k}{m}v \\
    \therefore dv                                 &= \left(-g - \frac{k}{m}v\right) dt \\
    \therefore dv                                 &= -\frac{k}{m}\left(\frac{m}{k}g + v\right) dt \\
    \therefore \frac{dv}{\frac{m}{k}g + v}        &= -\frac{k}{m} dt \\
    \therefore \log \left(\frac{m}{k}g + v\right) &= -\frac{k}{m}t + C \\
    \therefore v + \frac{m}{k}g                   &= e^{-\frac{k}{m}t + C} \\
    \therefore v                                  &= -\frac{m}{k}g + Ce^{-\frac{k}{m}t}
\end{align*}
$$

初期条件 $t = 0$ で $v = 0$ を代入して、

$$
\begin{align*}
    C            &= \frac{mg}{k}\\
    \therefore v &= \frac{mg}{k}\left(e^{-\frac{k}{m}t} - 1\right) \\
    \therefore x &= \frac{mg}{k}\left(-\frac{m}{k}e^{-\frac{k}{m}t} - t\right) + D \\
\end{align*}
$$

初期条件 $t = 0$ で $x = 0$ を代入して、

$$
\begin{align*}
    D            &= \frac{m^2g}{k^2} \\
    \therefore x &= \frac{mg}{k}\left(-\frac{m}{k}e^{-\frac{k}{m}t}-t\right) + \frac{m^2g}{k^2} \\
    \therefore x &= \frac{m^2g}{k^2}\left(1 - e^{-\frac{k}{m}t}\right) - \frac{mg}{k}t
\end{align*}
$$

これを使って、プログラムを作ると次のようになります。

<ViewSource path="/simulation/resisted_motion_analytical.ipynb" />

:::
